<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1.0,user-scalable=no">
  <title>The Cloverfield Paradox</title>
  <link href="https://fonts.googleapis.com/css2?family=Netflix+Sans:wght@400;500;700;900&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" crossorigin="anonymous" referrerpolicy="no-referrer" />
  <style>
    *{margin:0;padding:0;box-sizing:border-box;}
    body{background:#000;color:#fff;font-family:'Netflix Sans',sans-serif;overflow-x:hidden;line-height:1.5;}
    .backdrop{position:fixed;top:0;left:0;right:0;bottom:0;
      background:linear-gradient(to bottom,rgba(0,0,0,0.7),rgba(0,0,0,0.9)),url('https://image.tmdb.org/t/p/original/2cnUCcNmmj79hGmimvWlUo5P2K8.jpg') center/cover no-repeat;
      filter:blur(8px) brightness(0.6);z-index:-1;transform:scale(1.1);}
    .container{max-width:480px;margin:0 auto;padding:0 16px;}
    .header{padding-top:60px;text-align:center;}
    .poster{width:160px;height:240px;border-radius:8px;overflow:hidden;margin:0 auto 16px;
      box-shadow:0 8px 24px rgba(0,0,0,0.6);border:1px solid rgba(255,255,255,0.1);}
    .poster img{width:100%;height:100%;object-fit:cover;}
    .movie-logo{margin:12px auto;max-width:200px;max-height:60px;object-fit:contain;
      filter:drop-shadow(0 2px 4px rgba(0,0,0,0.8));display:block;}
    .title{font-size:28px;font-weight:900;margin-bottom:8px;text-shadow:0 2px 4px rgba(0,0,0,0.8);}
    .meta{font-size:14px;color:#aaa;margin-bottom:16px;}
    .meta span{margin-right:12px;}
    .match{color:#46d369;font-weight:700;}
    .actions{display:flex;justify-content:center;gap:16px;margin:24px 0;}
    .btn{display:flex;flex-direction:column;align-items:center;gap:6px;
      background:none;border:none;color:#fff;font-size:12px;font-weight:500;cursor:pointer;transition:transform .2s;}
    .btn:active{transform:scale(0.92);}
    .btn-icon{width:52px;height:52px;border-radius:50%;background:rgba(255,255,255,0.15);
      display:flex;align-items:center;justify-content:center;font-size:20px;transition:all .2s;}
    .btn-play .btn-icon{background:#fff;color:#000;font-size:24px;}
    .btn:hover .btn-icon{background:rgba(255,255,255,0.3);}
    .btn-play:hover .btn-icon{background:#e6e6e6;}
    .btn-download{margin-top:16px;background:rgba(255,255,255,0.1);border:1px solid rgba(255,255,255,0.3);
      color:#fff;padding:12px 24px;border-radius:4px;font-weight:600;width:100%;font-size:15px;
      display:flex;align-items:center;justify-content:center;gap:8px;transition:all .2s;}
    .btn-download:active{background:rgba(255,255,255,0.2);transform:scale(0.98);}
    .synopsis{font-size:15px;color:#ccc;line-height:1.6;margin:24px 0;}
    .synopsis-title{color:#fff;font-weight:700;margin-bottom:8px;font-size:16px;}
    .btn-cast{position:fixed;top:18px;right:18px;background:rgba(255,255,255,0.12);
      border:1px solid rgba(255,255,255,0.25);color:#fff;width:46px;height:46px;border-radius:50%;
      display:flex;align-items:center;justify-content:center;font-size:22px;cursor:pointer;
      z-index:10000;backdrop-filter:blur(8px);transition:all 0.25s;}
    .btn-cast:hover{background:rgba(255,255,255,0.3);transform:scale(1.1);}
    .btn-cast:active{transform:scale(0.9);}
    @media(max-width:380px){
      .title{font-size:24px;}
      .poster{width:140px;height:210px;}
      .btn-cast{width:40px;height:40px;font-size:18px;top:10px;right:3px;}
    }

    /* === PANTALLA COMPLETA IFRAME === */
    #fullscreenIframe {
      position: fixed;
      top: 0; left: 0; right: 0; bottom: 0;
      width: 100vw; height: 100vh;
      background: #000;
      z-index: 99999;
      display: none;
      flex-direction: column;
    }
    #iframeContainer {
      flex: 1;
      position: relative;
    }
    #iframeContainer iframe {
      width: 100%;
      height: 100%;
      border: none;
    }
    #closeIframeBtn {
      position: absolute;
      top: 16px;
      right: 16px;
      background: rgba(0,0,0,0.7);
      border: none;
      color: white;
      width: 48px;
      height: 48px;
      border-radius: 50%;
      font-size: 22px;
      cursor: pointer;
      z-index: 100;
      display: flex;
      align-items: center;
      justify-content: center;
      backdrop-filter: blur(8px);
    }
    #closeIframeBtn:hover {
      background: rgba(0,0,0,0.9);
      transform: scale(1.1);
    }

    /* === MODAL INFO === */
    .modal-overlay {
      display: none;
      position: fixed;
      inset: 0;
      background: rgba(0, 0, 0, 0.85);
      backdrop-filter: blur(8px);
      justify-content: center;
      align-items: center;
      z-index: 9999;
      opacity: 0;
      transition: opacity 0.3s ease;
    }
    .modal-overlay.active {
      display: flex;
      opacity: 1;
    }
    .modal-card {
      background: #111;
      padding: 24px;
      border-radius: 14px;
      box-shadow: 0 0 20px rgba(255, 215, 0, 0.2);
      max-width: 480px;
      width: 90%;
      animation: fadeInUp 0.3s ease;
      color: #eee;
    }
    .close-btn {
      position: absolute;
      top: 12px;
      right: 12px;
      background: none;
      border: none;
      color: #fff;
      font-size: 20px;
      cursor: pointer;
    }
    .close-btn:hover { color: #ffd700; transform: scale(1.2); }
    .info-grid p { margin: 0 0 8px; font-size: 15px; line-height: 1.5; }
    @keyframes fadeInUp {
      from { transform: translateY(25px); opacity: 0; }
      to { transform: translateY(0); opacity: 1; }
    }
  </style>
</head>
<body>

  <button id="btnCast" class="btn-cast" title="Transmitir"><i class="fas fa-tv"></i></button>
  <div class="backdrop"></div>
  <div class="container">
    <div class="header">
      <div class="poster"><img src="https://image.tmdb.org/t/p/w500/hyeJDZxsXatr2XoPtH46NRrQ6aW.jpg" alt="The Cloverfield Paradox"></div>
      <img src="https://image.tmdb.org/t/p/original/pa7qShs8YSMQvQTpeiaJD2YYU5q.png" class="movie-logo" alt="logo">
      <h1 class="title">The Cloverfield Paradox</h1>
      <div class="meta">
        <span>Año: 2018</span>
        <span class="match">85% para ti</span>
        <span>102 min</span>
      </div>
    </div>
    <div class="actions">
      <button class="btn btn-play" id="btnReproducir" title="Reproducir">
        <div class="btn-icon"><i class="fas fa-play"></i></div><span>Reproducir</span>
      </button>
      <button class="btn" id="btnLista" title="Agregar a mi lista">
        <div class="btn-icon"><i class="fas fa-plus"></i></div><span>Mi lista</span>
      </button>
      <button class="btn" id="btnInfo" title="Más información">
        <div class="btn-icon"><i class="fas fa-info"></i></div><span>Info</span>
      </button>
    </div>
    <button class="btn-download" id="download-btn">
      <i class="fas fa-download"></i> Descargar
    </button>
    <div class="synopsis">
      <div class="synopsis-title">Sinopsis</div>
      <p id="synopsisText">Con la Tierra en guerra y en mitad de una crisis energética, un equipo de astronautas se encuentra en el espacio tratando de dar con una solución a los problemas del planeta. Pero durante una maniobra fallida, quedan flotando sin saber muy bien qué o cómo volver a su lugar de origen, y las cosas dentro de la nave ocultan una realidad mucho más terrorífica.</p>
      <button id="toggleSynopsis" style="display:none;background:none;border:none;color:#46d369;font-weight:700;cursor:pointer;margin-top:8px;">Ver más</button>
    </div>
  </div>

  <!-- PANTALLA COMPLETA IFRAME -->
  <div id="fullscreenIframe">
    <div id="iframeContainer">
      <button id="closeIframeBtn"><i class="fas fa-times"></i></button>
      <iframe id="playerIframe" src="" allowfullscreen allow="fullscreen"></iframe>
    </div>
  </div>

  <!-- MODAL INFO -->
  <div id="infoModal" class="modal-overlay">
    <div class="modal-card">
      <button id="closeModal" class="close-btn"><i class="fas fa-times"></i></button>
      <div class="info-grid">
        <p><strong>Director:</strong> Julius Avery</p>
        <p><strong>Género:</strong> Ciencia ficción, Terror, Suspenso</p>
        <p><strong>País:</strong> United States of America</p>
        <p><strong>Título Original:</strong> The Cloverfield Paradox</p>
        <p><strong>Eslogan:</strong> The future unleashed every thing</p>
        <p><strong>Presupuesto:</strong> $45.000.000</p>
        <p><strong>Ingresos:</strong> $0</p>
        <p><strong>Calificación:</strong> 5.6 / 10</p>
        <p><strong>Duración:</strong> 1h 42min</p>
      </div>
    </div>
  </div>

  <script>
    document.addEventListener('DOMContentLoaded', function() {
      console.clear();
      console.log('[DEBUG] App inicializada con iframe en pantalla completa');

      // === ELEMENTOS ===
      const btnReproducir = document.getElementById('btnReproducir');
      const fullscreenIframe = document.getElementById('fullscreenIframe');
      const playerIframe = document.getElementById('playerIframe');
      const closeIframeBtn = document.getElementById('closeIframeBtn');
      const downloadBtn = document.getElementById('download-btn');
      const castBtn = document.getElementById('btnCast');
      const btnLista = document.getElementById('btnLista');
      const btnInfo = document.getElementById('btnInfo');
      const infoModal = document.getElementById('infoModal');
      const closeModal = document.getElementById('closeModal');
      const synopsisText = document.getElementById('synopsisText');
      const toggleSynopsis = document.getElementById('toggleSynopsis');

      const IFRAME_URL = "https://lzrdrz10.github.io/repro/player.html?video=aHR0cHM6Ly8xYS0xNzkxLmNvbS92aWRlby9md2UyLzg1L3M4LzIvNi8yL0svcS82Mktxei5hYWEubXA0&poster=aHR0cHM6Ly9pbWFnZS50bWRiLm9yZy90L3Avb3JpZ2luYWwvMmNuVUNjTm1tajc5aEdtaW12V2xVbzVQMks4LmpwZw==&title=TGEgUGFyYWRvamEgQ2xvdmVyZmllbGQ=";
      const VIDEO_DESCARGA = "https://1a-1791.com/video/fwe2/85/s8/2/6/2/K/q/62Kqz.aaa.mp4";
      const maxLength = 200;

      let isFullscreen = false;

      // === REPRODUCIR EN PANTALLA COMPLETA (IFRAME + LANDSCAPE) ===
      btnReproducir.addEventListener('click', () => {
        console.log('[ACTION] Reproducir iframe en pantalla completa');
        isFullscreen = true;
        fullscreenIframe.style.display = 'flex';
        playerIframe.src = IFRAME_URL;

        // Forzar pantalla horizontal
        if (screen.orientation && screen.orientation.lock) {
          screen.orientation.lock('landscape').catch(err => console.warn('No se pudo bloquear orientación', err));
        }

        // Entrar en fullscreen
        if (fullscreenIframe.requestFullscreen) {
          fullscreenIframe.requestFullscreen();
        } else if (fullscreenIframe.webkitRequestFullscreen) {
          fullscreenIframe.webkitRequestFullscreen();
        }

        // Añadir estado al historial para capturar "Atrás"
        history.pushState({ page: 'video' }, '', '#video');
      });

      // === CERRAR PANTALLA COMPLETA ===
      function closeFullscreen() {
        if (!isFullscreen) return;
        console.log('[ACTION] Cerrar pantalla completa');
        isFullscreen = false;
        fullscreenIframe.style.display = 'none';
        playerIframe.src = '';
        document.body.style.overflow = '';

        // Desbloquear orientación
        if (screen.orientation && screen.orientation.unlock) {
          screen.orientation.unlock();
        }

        // Salir de fullscreen
        if (document.fullscreenElement) {
          document.exitFullscreen?.() || document.webkitExitFullscreen?.();
        }

        // Restaurar scroll
        window.scrollTo(0, 0);
      }

      closeIframeBtn.addEventListener('click', closeFullscreen);

      // === BOTÓN ATRÁS DEL MÓVIL ===
      window.addEventListener('popstate', (e) => {
        if (isFullscreen) {
          closeFullscreen();
          history.back(); // Evita bucle
        }
      });

      // === DESCARGAR ===
      downloadBtn.addEventListener('click', (e) => {
        e.preventDefault();
        const clean = VIDEO_DESCARGA.replace(/^https?:\/\//, '');
        const intentPlus = `intent://${clean}#Intent;package=idm.internet.download.manager.plus;scheme=https;end`;
        const intentNormal = `intent://${clean}#Intent;package=idm.internet.download.manager;scheme=https;end`;
        location.href = intentPlus;
        setTimeout(() => location.href = intentNormal, 1000);
      });

      // === CAST ===
      castBtn.addEventListener('click', () => {
        const clean = VIDEO_DESCARGA.replace(/^https?:\/\//, '');
        const intent = `intent://${clean}#Intent;package=com.instantbits.cast.webvideo;scheme=https;end`;
        window.open(intent, '_blank');
      });

      // === MI LISTA ===
      btnLista.addEventListener('click', () => {
        let lista = JSON.parse(localStorage.getItem('miLista') || '[]');
        const pageUrl = location.href;
        const exists = lista.some(m => m.pageUrl === pageUrl);

        if (!exists) {
          lista.push({
            titulo: "The Cloverfield Paradox",
            year: "2018",
            poster: "https://image.tmdb.org/t/p/w500/hyeJDZxsXatr2XoPtH46NRrQ6aW.jpg",
            backdrop: "https://image.tmdb.org/t/p/original/2cnUCcNmmj79hGmimvWlUo5P2K8.jpg",
            sinopsis: synopsisText.textContent.trim(),
            pageUrl,
            addedAt: new Date().toISOString()
          });
          localStorage.setItem('miLista', JSON.stringify(lista));
          btnLista.querySelector('i').classList.replace('fa-plus', 'fa-check');
          btnLista.querySelector('span').textContent = 'Añadido';
        } else {
          lista = lista.filter(m => m.pageUrl !== pageUrl);
          localStorage.setItem('miLista', JSON.stringify(lista));
          btnLista.querySelector('i').classList.replace('fa-check', 'fa-plus');
          btnLista.querySelector('span').textContent = 'Mi lista';
        }
      });

      // Inicializar estado de lista
      (function() {
        const lista = JSON.parse(localStorage.getItem('miLista') || '[]');
        if (lista.some(m => m.pageUrl === location.href)) {
          btnLista.querySelector('i').classList.replace('fa-plus', 'fa-check');
          btnLista.querySelector('span').textContent = 'Añadido';
        }
      })();

      // === VER MÁS SINOPSIS ===
      if (synopsisText.textContent.length > maxLength) {
        const full = synopsisText.textContent.trim();
        const short = full.slice(0, maxLength) + '...';
        synopsisText.textContent = short;
        toggleSynopsis.style.display = 'inline-block';
        let expanded = false;
        toggleSynopsis.addEventListener('click', () => {
          synopsisText.textContent = expanded ? short : full;
          toggleSynopsis.textContent = expanded ? 'Ver más' : 'Ver menos';
          expanded = !expanded;
        });
      }

      // === MODAL INFO ===
      btnInfo.addEventListener('click', () => {
        infoModal.classList.add('active');
        document.body.style.overflow = 'hidden';
      });
      closeModal.addEventListener('click', () => {
        infoModal.classList.remove('active');
        document.body.style.overflow = '';
      });
      infoModal.addEventListener('click', (e) => {
        if (e.target === infoModal) {
          infoModal.classList.remove('active');
          document.body.style.overflow = '';
        }
      });

      console.log('[DEBUG] Todo listo. Pulsa Reproducir para probar.');
    });
  </script>
</body>
</html>
